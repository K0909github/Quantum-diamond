## Ar implantation test with C/N Tersoff + Ar–C Lennard-Jones

# Newton's third law
newton on

units metal
atom_style atomic
dimension 3
boundary p p p

# Simulation cell (large enough to hold 160 Å substrate + vacuum)
region          mybox0 block -500 500 -500 500 -500 500
create_box      3 mybox0  # type1=C_sub, type2=Fixed_C, type3=Ar

# Neighbor list settings
neighbor        2.0 bin
neigh_modify    every 1 delay 0 check yes

# Provide your equilibrated diamond substrate data file here
read_data       diamond_160A_with_vacancies.data add append

group           C_sub type 1
group           Fixed_sub type 2

# Ar atom injection (1 atom)
create_atoms    3 single 0 0 70 units box
mass 3          39.948
group           Ar_atom type 3

# Initialization
velocity        C_sub create 300 12345 mom yes dist gaussian
velocity        Fixed_sub set 0.0 0.0 0.0
# 1.6 keV Ar -> v ≈ 8.79e2 Å/ps in metal units
velocity        Ar_atom set 0 0 -879.0

# Force field: Tersoff/ZBL for C–C, Lennard-Jones for Ar-related pairs
pair_style      hybrid tersoff/zbl lj/cut 10.0
pair_coeff      * * tersoff/zbl diamond_nv.tersoff.zbl C C NULL
# LJ parameters (epsilon [eV], sigma [Å], cutoff [Å])
pair_coeff      3 3 lj/cut 0.0104 3.40 10.0
pair_coeff      1 3 lj/cut 0.0104 3.45 10.0
pair_coeff      2 3 lj/cut 0.0104 3.45 10.0

# Operation
timestep        0.0001

fix             hold Fixed_sub setforce 0.0 0.0 0.0
fix             f1 all nve

# Output
thermo          100
thermo_style    custom time step ke pe etotal temp press

dump            Ar_to_Csub all xyz 10 1atom_1.6keV_Ar_to_Csub.xyz
dump_modify     Ar_to_Csub element C_Sub Fixed_C Ar

run             1000

undump          Ar_to_Csub
write_data      1atom_1.6keV_Ar_to_C.data
