

# ダイヤモンド中NVセンター生成シミュレーション

本プロジェクトは、窒素ドープダイヤモンド中でのNVセンター生成過程を分子動力学（MD）法でシミュレートするものです。LAMMPSを用いて、イオン注入からアニーリング、冷却までの一連のプロセスを原子スケールで再現します。

## シミュレーション全体の流れ

1. **初期設定**  
	単位系や境界条件、原子スタイルの指定。
2. **シミュレーションボックスと原子の作成**  
	ダイヤモンド格子（格子定数3.57Å）で40×40×30（単位:格子）サイズのボックスを作成。原子タイプ1（炭素）、タイプ2（窒素）を定義。
3. **領域・グループ分け**  
	newton層（z=2～28）、サーモスタット層（z=0～2）などを設定。
4. **ポテンシャルの設定**  
	Tersoff/ZBLポテンシャル（BNC_tersoff_zbl.potential）を指定。
5. **初期緩和**  
	293Kで速度付与し、NVT/Langevinで10ps（タイムステップ1fs×10,000ステップ）緩和。
6. **窒素イオン注入**  
	1.6keVのエネルギーで窒素イオン（タイプ2）をZ方向上部から注入（depositコマンド）。350ps（1fs×350,000ステップ）注入シミュレーション、続けて150ps（1fs×150,000ステップ）緩和。
7. **アニーリング**  
	293K→1600Kへ50ps（1fs×50,000ステップ）かけて昇温。1600Kで7.4ns（1fs×7,400,000ステップ）保持。
8. **冷却と最終緩和**  
	1600K→293Kへ50ps（1fs×50,000ステップ）かけて冷却。293Kで100ps（1fs×100,000ステップ）最終緩和。

---

## 各工程の詳細と数値

### 1. 初期設定
- 単位系: metal
- 次元: 3次元
- 境界条件: X,Y=周期的 (p)、Z=固定 (f)
- 原子スタイル: atomic

### 2. シミュレーションボックスと原子の作成
- 格子: diamond, 格子定数3.57Å
- ボックス: 0～40, 0～40, 0～30（単位:格子）
- 原子数: 最大約384,000個（40×40×30×8/8）
- 原子タイプ: 1=炭素(C), 2=窒素(N)

### 3. 領域・グループ分け
- newton層: z=2～28（主に運動する領域）
- サーモスタット層: z=0～2（温度制御）
- simulation_atoms: newton_atomsとthermostat_atomsの和集合

### 4. ポテンシャルの設定
- pair_style: tersoff/zbl
- pair_coeff: BNC_tersoff_zbl.potential, C N
- 隣接リスト: 2.0Å, delay 10

### 5. 初期緩和
- 速度付与: 293K, 乱数種54321
- 温度制御: NVT（時定数0.1ps）, Langevin（時定数0.1ps, 乱数種98765）
- 時間: 10ps（タイムステップ1fs×10,000ステップ）

### 6. 窒素イオン注入
- イオンエネルギー: 1.6keV（1600eV）
- 注入粒子: 窒素（タイプ2）
- 速度: エネルギーから計算（約348,000 m/s）
- 注入方向: Z上端から-Z方向
- depositコマンドで2個ずつ注入、最大100回
- 注入時間: 350ps（1fs×350,000ステップ）
- 注入後緩和: 150ps（1fs×150,000ステップ）

### 7. アニーリング
- 293K→1600Kへ50ps（1fs×50,000ステップ）昇温
- 1600Kで7.4ns（1fs×7,400,000ステップ）保持

### 8. 冷却と最終緩和
- 1600K→293Kへ50ps（1fs×50,000ステップ）冷却
- 293Kで100ps（1fs×100,000ステップ）最終緩和

---

## なぜ窒素（N）を注入するのか

このシミュレーションでは、NVセンター（窒素原子＋隣接空孔）を効率よく作るため、
あらかじめダイヤモンド中に窒素原子を含めておき、さらに高エネルギーの窒素イオンを注入して空孔や欠陥を生成します。
注入後のアニーリングで空孔が窒素原子の隣に移動し、NVセンターが形成されます。

---

## 目的

このシミュレーションにより、イオン注入によるNVセンター生成メカニズムや最適条件を原子スケールで解明します。