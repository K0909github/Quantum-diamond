#1atoms_1.6keV_N_implantation_to_C_ZBL_potential_filedata.txt
# Newton's third law
newton on

units metal
atom_style atomic
dimension 3
boundary p p p

# setting_simulation_box
region          mybox0 block -500 500 -500 500 -500 500
create_box      3 mybox0 # 3 types: C_sub(1), Fixed_sub(2), N(3)

# Neighbor list settings 
neighbor        2.0 bin 
neigh_modify    every 1 delay 0 check yes

# set_up atom (provide your C substrate data)
# NOTE: 下の read_data のファイル名は手元のダイヤモンドC基板データに合わせて変更してください。
# 例: diamond_substrate/diamond_300K_annealed.data など。
read_data       diamond_160A_with_vacancies.data add append

# グループ定義（type 1: C、type 2: 固定層C、type 3: N）
group           C_sub type 1
group           Fixed_sub type 2

# N atom injection (1 atom)
# 基板の上方(z=100 Å)に1原子のNを配置（座標はbox単位で指定）
create_atoms    3 single 0 0 70 units box
mass 3          14.0067 # N
group           N_atom type 3

# Initialization
velocity        C_sub create 300 12345 mom yes dist gaussian   # type 1
velocity        Fixed_sub set 0.0 0.0 0.0                      # type 2
# 1.6 keV のN原子入射（units metalでは速度はÅ/ps）
# 1.6 keV, m(N)=14.0067 amu -> v ≈ 1484.6 Å/ps
velocity        N_atom set 0 0 -1484.6 #units box                          # type 3, 1.6keV

# Force field 
# このバイナリ（2024-02-07）の他入力例に合わせ、zblに2引数を与える（例: 4.5 4.5）
pair_style      tersoff/zbl 
pair_coeff      * * diamond_nv.tersoff.zbl C C N

neigh_modify delay 0

# Operation
timestep        0.0001

fix             hold Fixed_sub setforce 0.0 0.0 0.0
fix             f1 all nve

# Output
thermo          100 # Display every 1000 timesteps
thermo_style    custom time ke pe etotal temp


# --- original dump settings (kept for reference; writing under /mnt/c/OneDrive may cause I/O errors on WSL) ---
dump            N_to_Csub all xyz 10 1atom_1.6keV_N_to_Csub.xyz
dump_modify     N_to_Csub element C_Sub Fixed_C N

# Actions
run             1000

undump          N_to_Csub
write_data      1atom_1.6keV_N_to_C.data
